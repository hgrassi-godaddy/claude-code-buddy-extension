<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src {{cspSource}} 'unsafe-inline'; script-src 'nonce-{{nonce}}'; img-src {{cspSource}};">
    <title>Claude Buddy</title>
    <link rel="stylesheet" href="{{mainCss}}">
    <link rel="stylesheet" href="{{buddyCss}}">
    <link rel="stylesheet" href="{{chatCss}}">
    <link rel="stylesheet" href="{{navigationCss}}">
    <link rel="stylesheet" href="{{animationsCss}}">
    <link rel="stylesheet" href="{{friendshipCss}}">
</head>
<body>
    <div class="container">
        <!-- Large Buddy Section -->
        <div class="buddy-section">
            <!-- Buddy Header with Friendship -->
            <div class="buddy-header">
                <div class="friendship-compact" id="friendshipCompact" style="cursor: pointer;">
                    <span class="friendship-label" id="friendshipLabel">ü©µ Friendship 0%</span>
                    <div class="friendship-bar-small">
                        <div class="friendship-progress" id="friendshipProgress"></div>
                    </div>
                    <div class="friendship-tooltip" id="friendshipTooltip">Just Getting Started! üëã</div>
                </div>
            </div>

            <div class="buddy-avatar">
                <div class="cyborg-container">
                    {{avatarSvg}}
                </div>
                <button class="lets-code-button" id="letscodeBtn">Let's Code!</button>
            </div>

            <!-- Navigation Interface -->
            <div class="customization-nav">
                <div class="nav-header">
                    <button class="nav-arrow" id="prevBtn">‚Äπ</button>
                    <span class="nav-title" id="navTitle">Style</span>
                    <button class="nav-arrow" id="nextBtn">‚Ä∫</button>
                </div>

                <!-- Style Panel -->
                <div class="customization-panel active" id="stylePanel">
                    <div class="style-controls">
                        <div class="style-btn active" data-style="cyberpunk">üåÉ Cyber</div>
                        <div class="style-btn" data-style="academic">üéì Academic</div>
                        <div class="style-btn" data-style="casual">üëï Casual</div>
                    </div>
                </div>

                <!-- Skin Color Panel -->
                <div class="customization-panel" id="skinPanel">
                    <div class="color-picker-container">
                        <input type="color" id="skinColorPicker" value="#C0C0C0" class="color-picker">
                    </div>
                </div>

                <!-- Hair Panel (Styles + Color Picker) -->
                <div class="customization-panel" id="hairPanel">
                    <!-- Hair Style Controls -->
                    <div class="style-controls" style="margin-bottom: 8px;">
                        <div class="style-btn active" data-hair-style="1" style="font-size: 10px;">Bald</div>
                        <div class="style-btn" data-hair-style="2" style="font-size: 10px;">Spiky</div>
                        <div class="style-btn" data-hair-style="3" style="font-size: 10px;">Long</div>
                        <div class="style-btn" data-hair-style="4" style="font-size: 10px;">Clean Cut</div>
                    </div>
                    <!-- Hair Color Picker -->
                    <div class="color-picker-container">
                        <input type="color" id="hairColorPicker" value="#8B4513" class="color-picker">
                    </div>
                </div>

                <!-- Eye Color Panel -->
                <div class="customization-panel" id="eyePanel">
                    <div class="color-picker-container">
                        <input type="color" id="eyeColorPicker" value="#ec4899" class="color-picker">
                    </div>
                </div>

                <!-- Accessories Panel -->
                <div class="customization-panel" id="accessoryPanel">
                    <div class="style-controls" style="margin-bottom: 8px;">
                        <div class="style-btn" data-accessory="glasses" style="font-size: 10px;">Glasses</div>
                        <div class="style-btn" data-accessory="earrings" style="font-size: 10px;">Earrings</div>
                        <div class="style-btn" data-accessory="cat" style="font-size: 10px;">Cat</div>
                        <div class="style-btn" data-accessory="dog" style="font-size: 10px;">Dog</div>
                    </div>
                    <!-- Individual Color Pickers -->
                    <div class="color-picker-container">
                        <div id="glasses-color-picker" class="individual-color-picker" style="display: none; margin-bottom: 4px;">
                            <label style="font-size: 10px; color: var(--vscode-foreground);">Glasses:</label>
                            <input type="color" id="glassesColorPicker" value="#E74C3C" class="color-picker">
                        </div>
                        <div id="earrings-color-picker" class="individual-color-picker" style="display: none; margin-bottom: 4px;">
                            <label style="font-size: 10px; color: var(--vscode-foreground);">Earrings:</label>
                            <input type="color" id="earringsColorPicker" value="#FFD700" class="color-picker">
                        </div>
                        <div id="cat-color-picker" class="individual-color-picker" style="display: none; margin-bottom: 4px;">
                            <label style="font-size: 10px; color: var(--vscode-foreground);">Cat:</label>
                            <input type="color" id="catColorPicker" value="#FF8C42" class="color-picker">
                        </div>
                        <div id="dog-color-picker" class="individual-color-picker" style="display: none; margin-bottom: 4px;">
                            <label style="font-size: 10px; color: var(--vscode-foreground);">Dog:</label>
                            <input type="color" id="dogColorPicker" value="#8B4513" class="color-picker">
                        </div>
                    </div>
                </div>

                <!-- Tops Panel -->
                <div class="customization-panel" id="topPanel">
                    <div class="style-controls" style="margin-bottom: 8px;">
                        <div class="style-btn active" data-top="tanktop" style="font-size: 10px;">Tank Top</div>
                        <div class="style-btn" data-top="tshirt" style="font-size: 10px;">T-Shirt</div>
                        <div class="style-btn" data-top="hoodie" style="font-size: 10px;">Hoodie</div>
                        <div class="style-btn" data-top="vest" style="font-size: 10px;">Vest</div>
                    </div>
                    <div class="color-picker-container">
                        <input type="color" id="topColorPicker" value="#3498DB" class="color-picker">
                    </div>
                </div>

                <!-- Bottoms Panel -->
                <div class="customization-panel" id="bottomPanel">
                    <div class="style-controls" style="margin-bottom: 8px;">
                        <div class="style-btn active" data-bottom="pants" style="font-size: 10px;">Pants</div>
                        <div class="style-btn" data-bottom="skirt" style="font-size: 10px;">Skirt</div>
                    </div>
                    <div class="color-picker-container">
                        <input type="color" id="bottomColorPicker" value="#2C3E50" class="color-picker">
                    </div>
                </div>

                <!-- Shoes Panel -->
                <div class="customization-panel" id="shoePanel">
                    <div class="color-picker-container">
                        <input type="color" id="shoeColorPicker" value="#1A1A1A" class="color-picker">
                    </div>
                </div>

                <!-- Expression Panel -->
                <div class="customization-panel" id="expressionPanel">
                    <div class="style-controls">
                        <div class="style-btn active" data-expression="neutral" style="font-size: 10px;">üòê Neutral</div>
                        <div class="style-btn" data-expression="happy" style="font-size: 10px;">üòä Happy</div>
                        <div class="style-btn" data-expression="excited" style="font-size: 10px;">ü§© Excited</div>
                        <div class="style-btn" data-expression="focused" style="font-size: 10px;">ü§î Focused</div>
                        <div class="style-btn" data-expression="sleepy" style="font-size: 10px;">üò¥ Sleepy</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Section -->
        <div class="chat-section">
            <div id="messages" class="messages"></div>
            <div class="input-container">
                <textarea id="messageInput" placeholder="Message Buddy..." maxlength="500" rows="1"></textarea>
                <button id="successSoundButton" title="Play success sound">‚úÖ</button>
                <button id="failureSoundButton" title="Play failure sound">‚ùå</button>
                <button id="alertSoundButton" title="Play alert sound">üîî</button>
                <button id="sendButton">Send</button>
            </div>
        </div>

        <!-- Friendship Modal Overlay -->
        <div class="friendship-modal" id="friendshipModal" style="display: none;">
            <div class="friendship-modal-backdrop" id="friendshipModalBackdrop"></div>
            <div class="friendship-modal-content">
                <div class="friendship-modal-header">
                    <h2>üíñ Friendship Progress</h2>
                    <div class="friendship-modal-header-buttons">
                        <button class="friendship-reset-btn" id="friendshipResetBtn" title="Reset Friendship Progress">üîÑ</button>
                        <button class="friendship-modal-close" id="friendshipModalClose">√ó</button>
                    </div>
                </div>

                <div class="friendship-modal-body">
                    <!-- Category Progress Bars -->
                    <div class="friendship-categories">
                        <div class="friendship-category">
                            <div class="friendship-category-header">
                                <span class="friendship-category-icon">üí¨</span>
                                <span class="friendship-category-name">Chat Interactions</span>
                                <span class="friendship-category-percent" id="chatPercent">0%</span>
                            </div>
                            <div class="friendship-category-bar">
                                <div class="friendship-category-progress" id="chatProgress" style="width: 0%"></div>
                            </div>
                        </div>

                        <div class="friendship-category">
                            <div class="friendship-category-header">
                                <span class="friendship-category-icon">‚ö°</span>
                                <span class="friendship-category-name">Claude Code Prompts</span>
                                <span class="friendship-category-percent" id="promptsPercent">0%</span>
                            </div>
                            <div class="friendship-category-bar">
                                <div class="friendship-category-progress" id="promptsProgress" style="width: 0%"></div>
                            </div>
                        </div>

                        <div class="friendship-category">
                            <div class="friendship-category-header">
                                <span class="friendship-category-icon">üîî</span>
                                <span class="friendship-category-name">Notifications</span>
                                <span class="friendship-category-percent" id="notificationsPercent">0%</span>
                            </div>
                            <div class="friendship-category-bar">
                                <div class="friendship-category-progress" id="notificationsProgress" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Overall Stats -->
                    <div class="friendship-stats">
                        <div class="friendship-stat">
                            <span class="friendship-stat-label">Total Points:</span>
                            <span class="friendship-stat-value" id="totalPoints">0</span>
                        </div>
                        <div class="friendship-stat">
                            <span class="friendship-stat-label">Total Level:</span>
                            <span class="friendship-stat-value" id="averageLevel">0%</span>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="friendship-activity">
                        <h3>Recent Activity</h3>
                        <div class="friendship-activity-list" id="recentActivity">
                            <div class="friendship-activity-empty">No recent activity</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script nonce="{{nonce}}" src="{{soundServiceJs}}"></script>
    <script nonce="{{nonce}}" src="{{mainJs}}"></script>
</body>
</html>